package multisig

import (
	"github.com/Zilliqa/gozilliqa-sdk/util"
	"strings"
	"testing"
)

func TestAggregatedPubKey(t *testing.T) {
	// msg := "7B9F5510D469495EEABD0D9AE0DC0E0575184AB2C03CA285A819A34400686DB5CBB8941BE218F2648DA991B18D0C379A669D4222DA24F7A9EAC308E3EDFB81AF22B5F43065A4DD25EFDC4C86CAAB3FBD4E2007B79A723CAE486DFB82088B8A5B13260BB9363E06EF639ABE4B0AC831A780EF58D5BBBC8881769FDFA217288A4634FC21D5F750D90067056A544E401896B8695AE4C74BD522338BAAC96A07D0D751221179B95A807F1215141BBE7A3649BCD3E4DDB68A7617C6C1EC8B7EFCA8B31813061E3B1D1A7CBCA88439CACED5671057BBF8662643F9AA369910702995359968BFE6349FA252759AB3137B7F78368DF5D9AE5AD51D1D5CCA4AEC2016241104E3977462BC72EBE01B26B9D95D8209A6AF96FF944F50E01DAEFE054B622768C5EA2AC054D0C1AE37C2515B8D74ECFD299ED1223A0C21893CA397AE69E6BCC4C07C1E5B7C9A9AC3B9C3ED033EE69FFB100F62E2696C9369D997C672D188870EDFA60EA777605663DD6484CF19737C5E36444C7F580910A8049633FC8EDBF0C9B3BDF30EB045629B36C293CEE1C594DF52CA3B5473455D69DAE4D12167567758653FF44179B1EB3067A6D1C70396F91C0976A74F4CF75A43382BC056C2A6E1D5EAAA30A85840BAA601990EEF8A9768977065C3C8FFE5E028335F559196C547B1D5072D46CB6E73510BB56F7A5E50800852348C017FBE4A2B95CDB489F982E5E5"
	// private key 1 44F865C7E5DC389CD8797FB219D1288C53AFFCED13B4FED7F04F1C7AD940F46A
	// private key 2 F981B36B10072FA2B873FB279B872D06B036DBCDA5BF7058AD2CBD927AFF2DBA
	// private key 3 AF8892AAA47CF0E12389E51660146481BF52729025DFABF9E269E53D9247F785
	// signature := "42DFF586CD6708894E78DA57AB448B168136B198D786D5F363CC19530C19EFFBE1C7DF11432E1FE1AFD5A5306B32AE1F28824925759A90836990F06A2E70CB19"
	pubKey1 := util.DecodeHex("0218A720B7EBCC45E7419E353A0782B0A7C33726D72361B978E92B96A669BF3867")
	pubKey2 := util.DecodeHex("029637AB898FD03535B9BB51BE7FB7F48F6E8481E213A000EF5D2BC04A378E7D7B")
	pubKey3 := util.DecodeHex("0357496874D1C65EE90F81BA2215E8881295D9AF5D972C9CCC0E79610632811F3E")
	pubKeys := [][]byte{pubKey1, pubKey2, pubKey3}
	aggregatedPubKey, err := AggregatedPubKey(pubKeys)
	pubKey := util.EncodeHex(aggregatedPubKey)
	if err != nil {
		t.Error(err)
	}
	// the target string is generated by cpp side
	if !strings.Contains(pubKey, strings.ToLower("02A6EFF003EB4E92EC46930BD2A994BA4B085B43AE70CBBA65AE77168B1807049F")) {
		t.Error("generate aggregated public key failed")
	}
}
