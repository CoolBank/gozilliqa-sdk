package core

import (
	"encoding/json"
	"github.com/Zilliqa/gozilliqa-sdk/util"
	"io/ioutil"
	"strings"
	"testing"
)

func Test_DeserializeFromJsonToDsBlockT(t *testing.T) {
	dsJson, err := ioutil.ReadFile("dsblock.json")
	if err != nil {
		t.Fatal(err.Error())
	}

	var dsBlockT DsBlockT
	err2 := json.Unmarshal(dsJson, &dsBlockT)
	if err2 != nil {
		t.Fatal(err2.Error())
	}


	dsBlockHeader := NewDsBlockHeaderFromDsBlockT(&dsBlockT)
	headerBytes := dsBlockHeader.Serialize()
	if "0A46080212205E0DBBA477EA36CCA0222CEB23E9B62262CDCDEB73BF2AB284C8C8B230D938371A206D3434708311D2F814279AA235B869A2DA45443FDCFAEE5625C5C60A1E297CA7100518032A230A210293F3A79C39A0C3952711B0F85440E9E5F96E4DC704AA431779ADEA817F12D8F23003380A42120A10000000000000000000000000773594004A320A30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000523D0A230A2103EEB8669191E26A163A9E3944B0150994CA04AD1CA7D0D9F1875AAE35148DD29312160A140000000000000000000000002E6C2A340000816D5AA5010A201F7A31292B4460E4F6559E684B37FBDE97CEB1C52CC23A4185F7EE612D1C447B1280010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" != strings.ToUpper(util.EncodeHex(headerBytes)) {
		t.Fail()
	}
}
